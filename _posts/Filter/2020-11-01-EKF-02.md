---
layout: post
title: 扩展卡尔曼EKF
category: 'Track'
order: 2
---

**Key Words**
1. 非线性方程
2. 泰勒级数展开
3. 雅可比矩阵

- - -
<br>
## **一、为什么会有扩展卡尔曼**
使用标准卡尔曼(KF)滤波的前提是系统的转移矩阵和量测矩阵都是**线性方程**，即整个系统状态是一个**线性状态**。因此，针对**非线性系统**，标准卡尔曼将无法适用，由此提出**扩展卡尔曼EKF**和后文的**无迹卡尔曼**以及其他非线性系统滤波器。

<br>
扩展卡尔曼的解决办法是对系统方程进行**泰勒级数展开**并截取前若干项。根据对泰勒展开式截取的阶数，将EKF分为一阶EKF(irst order EKF)和二阶EKF(econd order EKF)。

<br>
## **二、扩展卡尔曼流程一览**
<div align=center>
<img src="{{site.url}}/images/ekf-01.jpg"/>

</div>
EKF与KF相似，过程中只需要计算转移或观测方程的泰勒展开式然后带入相关公式即可。

<br>
## **三、步骤分解**	

**1. 根据k时刻状态、协方差得到k+1时刻预测值：**

$$ \hat{X}({k+1|k})=f(k,\hat{X}({k|k}))$$

$$ {P}({k+1|k})=F(k){P}({k|k})F(k)^{'}+Q(k)$$

	P(k+1|k)对角线元素代表了预测的精度，值越小则说明预测越准确。
	F是运动方程的雅克比矩阵。

**2. 量测预测**

$$ \hat{Z}({k+1|k})=h(k,\hat{X}({k+1|k})) $$

**3. 计算新息状态和新息协方差**

$$ {v}({k+1|k})=Z(k+1)-\hat{Z}({k+1|k}) $$

$$ {S}({k+1})=H(k+1){P}({k+1|k})H(k+1)^{'}+R(k+1)$$

	S(k+1)表示了新息的不确定性，其越小则说明量测越准确。
	同样，H是观测方程的雅克比矩阵。

**4. 计算卡尔曼增益**

$$ {K}({k+1})={P}({k+1|k})H(k+1)^{'}S^{-1}(k+1)$$

	增益K(k+1)表示了新的量测值对状态估计量的贡献大小。

**5. 状态、协方差更新**

$$ \hat{X}({k+1|k+1})=\hat{X}({k+1|k})+{K}({k+1}){v}({k+1|k})$$

$$ {P}({k+1|k+1})=[I-{K}({k+1})H(k+1)]{P}({k+1|k})	$$

- - -
```matlab
   Xn=f(Xekf(:,i-1));%一步预测
   P1=F*P0*F'+G*Q*G';%预测误差协方差
   z1=h(Xn);%观测预测

   %求解雅克比矩阵H
   H=[(Xn(1,1)-x0)/z1,0,(Xn(3,1)-y0)/z1,0];%泰勒展开的一阶近似
   K=P1*H'*inv(H*P1*H'+R);%卡尔曼最优增益
   Xekf(:,i)=Xn+K*(Z(:,i)-z1);%状态更新
   P0=(eye(n)-K*H)*P1;%滤波误差协方差更新
```


- - -
<br>
**相关链接**

[标准卡尔曼KF](https://hcheng1005.github.io/track/2020/10/25/KF-01.html)

[扩展卡尔曼EKF](https://hcheng1005.github.io/track/2020/11/01/EKF-02.html)

[无迹卡尔曼UKF](https://hcheng1005.github.io/dsp/2020/11/01/UKF-03.html)

- - -
<br>
**参考资料**

[1. 雷达目标跟踪技术]({{site.url}}/pdfs/雷达目标跟踪技术.pdf)

[2. 基于Kalman滤波的雷达目标跟踪算法研究]({{site.url}}/pdfs/基于Kalman滤波的雷达目标跟踪算法研究.pdf)